{{ define "main" }}
{{ partial "breadcrumb.html" . }}

<article class="panel post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="name headline">{{ .Title }}</h1>
        <div class="meta">
            {{ if .PublishDate }}
            <time itemprop="datePublished" datetime="{{ .PublishDate }}">{{ .PublishDate.Format "January 2, 2006"
                }}</time>
            {{ end }}
            <span>{{ .ReadingTime }} {{ if eq .ReadingTime 1 }} minute {{ else }} minutes {{ end }} read</span>
            <ul class="tag-list">
                {{ range (.GetTerms "tags") }}
                <li><a href="{{ .Permalink }}">{{ .LinkTitle }}</a></li>
                {{ end }}
            </ul>
        </div>
        {{ $img := (.Resources.ByType "image").GetMatch "featured*" }}
        {{ with $img }}
        <img itemprop="thumnailUrl" class="cover-img" src="{{ .Permalink }}" alt="Cover image for: '{{ $.Title }}'">
        {{ end }}
        <div id="toc-container">
            <label id="toc-heading" for="toggle-toc">Table Of Contents</label>
            <input type="checkbox" id="toggle-toc" aria-label="toggle visibility of table of contents">
            {{.TableOfContents}}
        </div>
    </header>
    <div itemprop="articleBody">
        {{ .Content }}
    </div>
</article>

<div class="panel">
    <h2>See Also</h2>
    {{ $related := .Site.RegularPages.Related . | first 6 }}
    {{ with $related }}
    <div class="posts">
        {{ range . }}
        <article>
            <ul class="tag-list compact">
                {{ range (.GetTerms "tags") }}
                <li><a href="{{ .Permalink }}">{{ .LinkTitle }}</a></li>
                {{ end }}
            </ul>
            <h3 class="header"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
            <p>{{ .Description }}...</p>
            {{ if .PublishDate }}
            <time datetime="{{ .PublishDate }}">{{ .PublishDate.Format "January 2, 2006"
                }}</time>
            {{ else }}
            <time>no date</time>
            {{ end }}
        </article>
        {{ end }}
    </div>
    {{ end }}
</div>

{{ end }}
